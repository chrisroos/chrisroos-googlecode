<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml">

  <head>
    <meta name="microid" content="ff511e16d7108be450fccd6f4611cf8d1d5416d1" />
    <meta http-equiv="content-type" content="text/html; charset=utf-8" />
    <link rel="alternate" type="application/rss+xml" title="RSS" href="http://feeds.feedburner.com/DeferredUntilInspirationHits" />
    <link rel="stylesheet" href="/stylesheets/azure.css" media="all" type="text/css" />
    <link rel="stylesheet" href="/stylesheets/print.css" media="print" type="text/css" />
    <link rel="openid.server" href="http://www.myopenid.com/server"/>
    <link rel="openid.delegate" href="http://chrisroos.myopenid.com/"/>
    <title>Posts tagged cool - deferred until inspiration hits</title>
  </head>

  <body>
  
    <div id="container" class="clearfix">
    
      <div id="header">
        <div id="logo">
          <h1 id="sitename"><a href="/">deferred until inspiration hits</a></h1>
        </div>
      </div>

      <div id="search">
      </div>

      <div id="content" class="clearfix">

        <div id="main">

          
            <div class="post">
              <h2>
                <a href="/articles/2007/09/04/permalinks-for-del-icio-us-bookmarks-posts">Permalinks for del.icio.us bookmarks (posts)</a>
              </h2>
              <p class="auth">
                Posted by Chris Roos
                <span class="typo_date" title="Tue, 04 Sep 2007 23:23:00">
                  Tue, 04 Sep 2007 23:23:00
                </span>
              </p>
          
              <p>I&#8217;ve wondered in the <a href="http://tech.groups.yahoo.com/group/ydn-delicious/message/1447">past</a> about sending <a href="http://en.wikipedia.org/wiki/Trackback">trackbacks</a> (or <a href="http://en.wikipedia.org/wiki/Pingback">pingbacks</a>) to bookmarked resources on <a href="http://del.icio.us">del.icio.us</a>.  As with most things, you can either wait for someone to do it for you, or you can do it yourself&#8230;  I started to investigate last Thursday afternoon and soon got sucked into the much more interesting issue of the missing <a href="http://en.wikipedia.org/wiki/Permalink">permalinks</a> for bookmarks.  You see, every time you bookmark something on del.icio.us, you are creating a new <a href="http://en.wikipedia.org/wiki/Representational_State_Transfer#REST.27s_Central_Principle:_Resources">resource</a>.  Unfortunately, it&#8217;s a very sad :-( resource.  Sad because it doesn&#8217;t have a <a href="http://www.wikipedia.org/wiki/URL"><span class="caps">URL</span></a> and so can&#8217;t be linked to.  An anonymous resource floating around the world wide web looking for love.  Boo hoo.  Anyway, enough of that.  I figured that if we could assign a unique tag to each of these resources then they would, as a side effect, get a permalink (you can already get your bookmarks containing a given tag by using http://del.icio.us/USERNAME/MY_TAG).  I experimented with using the url as a tag.  Although there seem to be some limits on what you can use, I found that if you strip the protocol and trailing slash from a url you are generally OK.  So, if we bookmark <a href="http://news.bbc.co.uk"><span class="caps">BBC</span> News</a> and tag it with news.bbc.co.uk then we can access that individual bookmark at <a href="http://del.icio.us/chrisjroos/news.bbc.co.uk">http://del.icio.us/chrisjroos/news.bbc.co.uk</a>.</p>


	<p><a href="http://flickr.com/photos/chrisjroos/1293075032/"><img src="http://farm2.static.flickr.com/1140/1293075032_372cce286d_m.jpg" alt="" /></a></p>


	<p>As you can only bookmark the same <span class="caps">URL</span> once, it should guarantee that the url-tag is unique.  I can, however, see a problem with the trailing slash.  Although it&#8217;s possible to bookmark URLs that differ only in the trailing slash (http://example.com/article1 and http://example.com/article1/ for example), it doesn&#8217;t seem possible to create a tag that contains that same trailing slash.  OK, so we could always ensure that we remove the trailing slashes from the URLs we bookmark but that doesn&#8217;t seem like a very robust solution.</p>


	<p>While experimenting, I found that I could use forward slashes within my tags, www.foo.com/bar/baz for example.  So, I started prepending url/ to my url-tag so that I could easily recognise posts that already had permalinks.  It was at this time that I noticed the similarity between the del.icio.us url history page del.icio.us/url/MD5_OF_URL (e.g. <a href="http://del.icio.us/url/4961e08b5118fbfddec7fb18fa303151"><span class="caps">BBC</span> News</a>) and my permalinked bookmark, del.icio.us/chrisjroos/url/URL.  If I was to <a href="http://en.wikipedia.org/wiki/MD5">hash</a> the bookmarked url in the same way as del.icio.us then I would end up with a url like del.icio.us/chrisjroos/url/MD5_OF_URL.  You can see the similarity in the URLs below.</p>


	<ul>
	<li><a href="http://del.icio.us/chrisjroos/url/4961e08b5118fbfddec7fb18fa303151">http://del.icio.us/chrisjroos/url/4961e08b5118fbfddec7fb18fa303151</a></li>
		<li><a href="http://del.icio.us/url/4961e08b5118fbfddec7fb18fa303151">http://del.icio.us/url/4961e08b5118fbfddec7fb18fa303151</a></li>
	</ul>


	<p>It looks as though it&#8217;s part of del.icio.us itself doesn&#8217;t it?  Cool huh.  It&#8217;d be really cool to extend the del.icio.us <a href="http://www.mozilla.com/en-US/firefox/">firefox</a> <a href="https://addons.mozilla.org/en-US/firefox/addon/1532">extension</a> to automatically add this tag when bookmarking a site.</p>


	<p>I&#8217;ve created a crappy script that will add this url/MD5_OF_URL tag to each of your posts.  It&#8217;s hosted on <a href="http://chrisroos.googlecode.com/svn/trunk/delicious_url_tags">google code</a> and pasted below.  Err, use at your own risk by the way.</p>


<div class="typocode"><pre><code class="typocode_ruby"><span class="constant">USERNAME</span> <span class="punct">=</span> <span class="punct">'</span><span class="string">YOUR_USERNAME</span><span class="punct">'</span>
<span class="constant">PASSWORD</span> <span class="punct">=</span> <span class="punct">'</span><span class="string">YOUR_PASSWORD</span><span class="punct">'</span>
<span class="constant">POSTS_CACHE</span> <span class="punct">=</span> <span class="punct">'</span><span class="string">FILE_TO_STORE_YOUR_EXISTING_DELICIOUS_POSTS_IN</span><span class="punct">'</span>

<span class="comment"># GET ALL POSTS</span>
<span class="keyword">unless</span> <span class="constant">File</span><span class="punct">.</span><span class="ident">exists?</span><span class="punct">(</span><span class="constant">POSTS_CACHE</span><span class="punct">)</span>
  <span class="ident">puts</span> <span class="punct">&quot;</span><span class="string">Downloading all posts...</span><span class="punct">&quot;</span>
  <span class="ident">curl_cmd</span> <span class="punct">=</span> <span class="punct">&lt;&lt;-</span><span class="constant">EndCurl</span><span class="string">
curl &quot;https://api.del.icio.us/v1/posts/all&quot; <span class="escape">\
</span>-u&quot;<span class="expr">#{USERNAME}</span>:<span class="expr">#{PASSWORD}</span>&quot; <span class="escape">\
</span>-s
&gt; <span class="expr">#{POSTS_CACHE}</span></span><span class="constant">
  EndCurl</span>
  `<span class="comment">#{curl_cmd}`</span>
<span class="keyword">end</span>

<span class="ident">require</span> <span class="punct">'</span><span class="string">hpricot</span><span class="punct">'</span>
<span class="ident">require</span> <span class="punct">'</span><span class="string">md5</span><span class="punct">'</span>
<span class="ident">require</span> <span class="punct">'</span><span class="string">cgi</span><span class="punct">'</span>

<span class="keyword">def </span><span class="method">add_url_hash_to_post</span><span class="punct">(</span><span class="ident">post</span><span class="punct">)</span>
  <span class="ident">url</span> <span class="punct">=</span> <span class="constant">CGI</span><span class="punct">.</span><span class="ident">unescapeHTML</span><span class="punct">(</span><span class="ident">post</span><span class="punct">['</span><span class="string">href</span><span class="punct">'])</span>
  <span class="ident">url_hash</span> <span class="punct">=</span> <span class="constant">MD5</span><span class="punct">.</span><span class="ident">md5</span><span class="punct">(</span><span class="ident">url</span><span class="punct">)</span>
  <span class="ident">url</span> <span class="punct">=</span> <span class="constant">CGI</span><span class="punct">.</span><span class="ident">escape</span><span class="punct">(</span><span class="ident">url</span><span class="punct">)</span>

  <span class="ident">tags</span> <span class="punct">=</span> <span class="ident">post</span><span class="punct">['</span><span class="string">tag</span><span class="punct">'].</span><span class="ident">split</span><span class="punct">('</span><span class="string"> </span><span class="punct">').</span><span class="ident">collect</span> <span class="punct">{</span> <span class="punct">|</span><span class="ident">tag</span><span class="punct">|</span> <span class="constant">CGI</span><span class="punct">.</span><span class="ident">unescapeHTML</span><span class="punct">(</span><span class="ident">tag</span><span class="punct">)</span> <span class="punct">}</span>
  <span class="ident">tags</span> <span class="punct">&lt;&lt;</span> <span class="punct">&quot;</span><span class="string">url/<span class="expr">#{url_hash}</span></span><span class="punct">&quot;</span> <span class="keyword">unless</span> <span class="ident">tags</span><span class="punct">.</span><span class="ident">include?</span><span class="punct">(&quot;</span><span class="string">url/<span class="expr">#{url_hash}</span></span><span class="punct">&quot;)</span>
  <span class="ident">tags</span> <span class="punct">=</span> <span class="ident">tags</span><span class="punct">.</span><span class="ident">collect</span> <span class="punct">{</span> <span class="punct">|</span><span class="ident">tag</span><span class="punct">|</span> <span class="constant">CGI</span><span class="punct">.</span><span class="ident">escape</span><span class="punct">(</span><span class="ident">tag</span><span class="punct">)</span> <span class="punct">}</span>
  <span class="ident">tags</span> <span class="punct">=</span> <span class="ident">tags</span><span class="punct">.</span><span class="ident">join</span><span class="punct">('</span><span class="string"> </span><span class="punct">')</span>

  <span class="ident">shared</span> <span class="punct">=</span> <span class="ident">post</span><span class="punct">['</span><span class="string">shared</span><span class="punct">']</span>
  <span class="ident">description</span> <span class="punct">=</span> <span class="constant">CGI</span><span class="punct">.</span><span class="ident">escape</span><span class="punct">(</span><span class="constant">CGI</span><span class="punct">.</span><span class="ident">unescapeHTML</span><span class="punct">(</span><span class="ident">post</span><span class="punct">['</span><span class="string">description</span><span class="punct">']))</span>
  <span class="ident">extended</span> <span class="punct">=</span> <span class="constant">CGI</span><span class="punct">.</span><span class="ident">escape</span><span class="punct">(</span><span class="constant">CGI</span><span class="punct">.</span><span class="ident">unescapeHTML</span><span class="punct">(</span><span class="ident">post</span><span class="punct">['</span><span class="string">extended</span><span class="punct">']))</span>

  <span class="ident">curl_cmd</span> <span class="punct">=</span> <span class="punct">&lt;&lt;-</span><span class="constant">EndCurl</span><span class="string">
curl &quot;https://api.del.icio.us/v1/posts/add&quot; <span class="escape">\
</span>-u&quot;<span class="expr">#{USERNAME}</span>:<span class="expr">#{PASSWORD}</span>&quot; <span class="escape">\
</span>-d&quot;url=<span class="expr">#{url}</span>&quot; <span class="escape">\
</span>-d&quot;description=<span class="expr">#{description}</span>&quot; <span class="escape">\
</span>-d&quot;extended=<span class="expr">#{extended}</span>&quot; <span class="escape">\
</span>-d&quot;tags=<span class="expr">#{tags}</span>&quot; <span class="escape">\
</span>-d&quot;shared=<span class="expr">#{shared}</span>&quot; <span class="escape">\
</span>-s
</span><span class="constant">  EndCurl</span>
  `<span class="comment">#{curl_cmd}`</span>
<span class="keyword">end</span>

<span class="comment"># ADD THE URL/&lt;md5_hash&gt; TAG TO EACH POST</span>
<span class="ident">posts_xml</span> <span class="punct">=</span> <span class="constant">File</span><span class="punct">.</span><span class="ident">open</span><span class="punct">(</span><span class="constant">POSTS_CACHE</span><span class="punct">)</span> <span class="punct">{</span> <span class="punct">|</span><span class="ident">f</span><span class="punct">|</span> <span class="ident">f</span><span class="punct">.</span><span class="ident">read</span> <span class="punct">}</span>
<span class="ident">posts_doc</span> <span class="punct">=</span> <span class="constant">Hpricot</span><span class="punct">(</span><span class="ident">posts_xml</span><span class="punct">)</span>
<span class="ident">count</span> <span class="punct">=</span> <span class="number">1</span>
<span class="punct">(</span><span class="ident">posts_doc</span><span class="punct">/'</span><span class="string">posts</span><span class="punct">'/'</span><span class="string">post</span><span class="punct">').</span><span class="ident">each</span> <span class="keyword">do</span> <span class="punct">|</span><span class="ident">post_xml</span><span class="punct">|</span>
  <span class="ident">puts</span> <span class="punct">&quot;</span><span class="string">Bookmark: <span class="expr">#{count}</span></span><span class="punct">&quot;</span> <span class="keyword">if</span> <span class="punct">(</span><span class="ident">count</span> <span class="punct">%</span> <span class="number">5</span><span class="punct">)</span> <span class="punct">==</span> <span class="number">0</span>
  <span class="ident">add_url_hash_to_post</span><span class="punct">(</span><span class="ident">post_xml</span><span class="punct">.</span><span class="ident">attributes</span><span class="punct">)</span>
  <span class="ident">count</span> <span class="punct">+=</span> <span class="number">1</span>
<span class="keyword">end</span></code></pre></div>
            </div>
        
            <p class="meta">
              
                Tags 
                
                  <a href="/articles/tag/bookmark" rel="tag">bookmark</a>, 
                
                  <a href="/articles/tag/cool" rel="tag">cool</a>, 
                
                  <a href="/articles/tag/curl" rel="tag">curl</a>, 
                
                  <a href="/articles/tag/del.icio.us" rel="tag">del.icio.us</a>, 
                
                  <a href="/articles/tag/permalink" rel="tag">permalink</a>, 
                
                  <a href="/articles/tag/pingback" rel="tag">pingback</a>, 
                
                  <a href="/articles/tag/ruby" rel="tag">ruby</a>, 
                
                  <a href="/articles/tag/trackback" rel="tag">trackback</a>, 
                
              
            </p>
          
            <div class="post">
              <h2>
                <a href="/articles/2007/08/14/holiday-in-newqay">Holiday in Newqay</a>
              </h2>
              <p class="auth">
                Posted by Chris Roos
                <span class="typo_date" title="Tue, 14 Aug 2007 06:30:00">
                  Tue, 14 Aug 2007 06:30:00
                </span>
              </p>
          
              <p>We&#8217;ve been camping in <a href="http://en.wikipedia.org/wiki/Newquay">Newquay</a> for the past week.  I just thought I&#8217;d post a few unstructured notes about our time there.</p>


	<ul>
	<li>It took about six hours each way in the car.  Much better than last year&#8217;s nine or ten hour journeys each way.</li>
	</ul>


	<ul>
	<li>The weather was amazing.  Given the miserable forecast before we left, it couldn&#8217;t have been any better.</li>
	</ul>


	<ul>
	<li>We stayed at <a href="http://www.trencreekholidaypark.co.uk">Trencreek campsite</a>.  It was a good site about 15-20 minutes walk away from the northern end of town (coming out opposite <a href="http://www.tolcarnebeach.com">Tolcarne Beach</a>).  Along with the no single sex parties or <a href="http://ademweb.co.uk/blog/?p=750">single people</a> rule, they didn&#8217;t have any card facilities and requested that you to park on the right hand side of your tent &#8211; maybe they could modernise just a little&#8230;</li>
	</ul>


	<ul>
	<li>Spent some time at <a href="http://en.wikipedia.org/wiki/Fistral_Beach">Fistral beach</a>, watching the <a href="http://www.ripcurlboardmasters.com">Ripcurl Boardmasters</a> surfing competition, drinking <a href="http://en.wikipedia.org/wiki/Foster%27s_Lager">Fosters</a>, and <a href="http://en.wikipedia.org/wiki/Bodyboarding">body boarding</a>.  The South African commentator suggested that his mate took <a href="http://img.dailymail.co.uk/i/pix/2007/08_01/whiteSWNS00808_468x331.jpg">the picture</a> of the <a href="http://en.wikipedia.org/wiki/Great_white">great white</a> in <a href="http://en.wikipedia.org/wiki/South_africa">South Africa</a> a good few years ago (a story that seems to be confirmed by the <a href="http://www.guardian.co.uk/frontpage/story/0,,2144756,00.html">Guardian</a>).</li>
	</ul>


	<ul>
	<li>Bought a <a href="http://en.wikipedia.org/wiki/Skimboard">skimboard</a> and fell off hard at least twice.</li>
	</ul>


	<ul>
	<li>Bought a bar for my <a href="http://www.peterlynnkites.co.nz">kite</a> from <a href="http://www.airjam.co.uk">Airjam</a>.</li>
	</ul>


	<ul>
	<li>Had a good meal at the <a href="http://www.fistral-blu.co.uk">Fistral Blue</a> restaurant and took some pics of the <a href="http://flickr.com/photos/chrisjroos/1096710292/in/set-72157601392983638">sunset</a>.</li>
	</ul>


	<ul>
	<li>Had a rushed meal at the <a href="http://www.maharajah-restaurant.co.uk">Maharajah</a> restaurant.  Tip to restaurant owners, asking us to finish our drinks in another restaurant across the street (even if it does belong to you) will not make us want to come back.</li>
	</ul>


	<ul>
	<li>Took in the <a href="http://flickr.com/photos/chrisjroos/1096871898/in/set-72157601392983638">amazing views</a> along the coastal path from Newquay, via Porth to Watergate Bay for the Ripcurl unleashed music festival.</li>
	</ul>


	<ul>
	<li>Got to the festival site without any cash only to discover that there were no card facilities anywhere.  Having walked for an hour and ten minutes to get there, we had to pay Â£10 for a cab to take us back, virtually all the way to the campsite, to withdraw some money.  Ho hum.</li>
	</ul>


	<p>At the festival, we saw:</p>


	<ul>
	<li><a href="http://www.ffaf.co.uk">Funeral for a Friend</a>.  So much harder live than on their albums.</li>
	</ul>


	<ul>
	<li><a href="http://www.ash-official.com">Ash</a>.  I only really know their <a href="http://www.amazon.co.uk/1977-Ash/dp/B0000274GW">old stuff</a> so it was cool that that was what they mainly played.  It makes me wonder if that&#8217;s a sign that their newer stuff isn&#8217;t selling quite so well though&#8230;</li>
	</ul>


	<ul>
	<li><a href="http://www.newtonfaulkner.com">Newton Faulkner</a>.  Only caught the last three songs but was impressed with what I saw.</li>
	</ul>


	<ul>
	<li><a href="http://www.scottmatthewsmusic.co.uk">Scott Matthews</a>.  Boring.</li>
	</ul>


	<ul>
	<li><a href="http://www.guillemots.com">The Guillemots</a>.  Boring.</li>
	</ul>


	<ul>
	<li><a href="http://www.paolonutini.com">Paolo Nutini</a>.  Although the albums are pretty boring, he&#8217;s pretty cool live (having originally seen him at Isle of White festival).  It was a bit of a shame that he was so drunk as his strong accent is hard enough to understand at the best of times.</li>
	</ul>


	<ul>
	<li><a href="http://www.mattandkimmusic.com">Mat and Kim</a>.  An amazingly energetic band from New York that played in front of maybe 100 people in the <a href="http://www.relentlessenergy.com">relentless</a> tent.</li>
	</ul>


	<ul>
	<li><a href="http://en.wikipedia.org/wiki/Wakeboarding">Wakeboarding</a> and <a href="http://en.wikipedia.org/wiki/Wake_skating">Wakeskating</a> at the relentless tour.</li>
	</ul>


	<ul>
	<li><a href="http://en.wikipedia.org/wiki/Freestyle_Motocross">Freestyle motorcross</a> with the <a href="http://www.myspace.com/ukfmx"><span class="caps">UK FMX</span></a> team.</li>
	</ul>


	<p>All in all, a good week.</p>
            </div>
        
            <p class="meta">
              
                Tags 
                
                  <a href="/articles/tag/camping" rel="tag">camping</a>, 
                
                  <a href="/articles/tag/cool" rel="tag">cool</a>, 
                
                  <a href="/articles/tag/holiday" rel="tag">holiday</a>, 
                
                  <a href="/articles/tag/newquay" rel="tag">newquay</a>, 
                
              
            </p>
          
            <div class="post">
              <h2>
                <a href="/articles/2007/07/24/train-times-by-sms-or-improving-national-rail-enquiries">Train times by SMS (or, improving national rail enquiries)</a>
              </h2>
              <p class="auth">
                Posted by Chris Roos
                <span class="typo_date" title="Tue, 24 Jul 2007 14:40:00">
                  Tue, 24 Jul 2007 14:40:00
                </span>
              </p>
          
              <p>I was in need of finding some train times at the weekend.  I usually use the <a href="http://www.nationalrail.co.uk">national rail enquiries</a> website but was without Internet access at the time.  Instead, I found myself waiting for about 10 minutes in a telephone queue just to spend about 30 seconds getting the information I was after.  This played on my mind a bit so last night I started <a href="http://twitter.com/chrisroos/statuses/164273922">playing around</a> with automating the national rail timetable search.  That was relatively painless so I moved on to integrating with <a href="http://www.twitter.com">twitter</a> in order to provide an <span class="caps">SMS</span> interface to the service.  Within a couple of hours I had a twitterbot that receives timetable requests, looks up the times and sends them back to you.</p>


	<p>It&#8217;s actually currently all up and running.  Just follow <a href="http://twitter.com/natrailenq">natrailenq</a> on twitter and I&#8217;ll follow you right back<sup><a href="#fn1">1</a></sup> (this seems to be necessary in order to send direct messages between each other).  A timetable request must be of the format &#8216;origin_station (3 letter short code) destination_station (3 letter short code) depart_date (dd-mmmm) depart_time (hh:mm)&#8217;.  So, if we wanted to get times of trains from London Victoria (VIC) to Clapham Junction (CLJ) tomorrow midday, we&#8217;d send a message like so:</p>


<code>d natrailenq vic clj 25-july 12:00</code>

	<p>In this instance, we get the following response back.</p>


<code>natrailenq  11:55-&gt;12:02, 12:02-&gt;12:07, 12:03-&gt;12:09, 12:05-&gt;12:11, 12:06-&gt;12:11</code>

	<p>Cool huh.</p>


	<p>The code is <strong>nasty</strong>.  You can see just how nasty it in the <a href="http://chrisroos.googlecode.com/svn/trunk/nat-rail-enq/">repository</a>.  It feels as though this could go somewhere &#8211; unless I&#8217;m violating some terms and conditions that I haven&#8217;t read&#8230;  I make no guarantees as to how long the service will stay live, and I will certainly (probably) remove it if asked to.</p>


	<p id="fn1"><sup>1</sup> Well, just as soon as I can at least &#8211; it&#8217;s not automated at the moment.</p>
            </div>
        
            <p class="meta">
              
                Tags 
                
                  <a href="/articles/tag/cool" rel="tag">cool</a>, 
                
                  <a href="/articles/tag/nationalrail" rel="tag">nationalrail</a>, 
                
                  <a href="/articles/tag/sms" rel="tag">sms</a>, 
                
                  <a href="/articles/tag/timetable" rel="tag">timetable</a>, 
                
                  <a href="/articles/tag/twitter" rel="tag">twitter</a>, 
                
                  <a href="/articles/tag/twitterbot" rel="tag">twitterbot</a>, 
                
              
            </p>
          
            <div class="post">
              <h2>
                <a href="/articles/2007/07/12/wesabe-open-up-their-api-and-ask-me-to-help-write-their-press-release">Wesabe open up their API and ask me to help write their press release...</a>
              </h2>
              <p class="auth">
                Posted by Chris Roos
                <span class="typo_date" title="Thu, 12 Jul 2007 23:49:00">
                  Thu, 12 Jul 2007 23:49:00
                </span>
              </p>
          
              <p>Ok, so that second bit isn&#8217;t strictly true ;-)  I was, however, flattered to be contacted by Debbie from <a href="http://www.wesabe.com">Wesabe</a> to answer a few questions and maybe provide a quote for their press release.  They have just improved their service by <a href="http://blog.wesabe.com/index.php/2007/07/12/your-bank-has-a-rest-api-now-shhh-dont-tell-them/">offering</a> an <a href="http://www.wikipedia.org/wiki/API"><span class="caps">API</span></a> after all.</p>


	<p>They asked, and I answered by rambling quite a bit.  In the preview of the press release I&#8217;ve seen, my ramblings have been summarized in three words :-)  Hey, I&#8217;m just honoured they asked.  I also asked if I could post their questions and my reply here, so, in all its glory, here it be.</p>


	<p><strong>Debbie Pfeifer</strong></p>


	<p>Hey, Chris.</p>


	<p>I work with Marc Hedlund at Wesabe.  I know he gave you a heads up that we&#8217;re working on releasing an <span class="caps">API</span>.  We&#8217;re getting close &#8211; we plan to get it out either late this week or early next week &#8211; and I was writing to ask for a favor.</p>


	<p>I&#8217;m putting together a press release announcing the <span class="caps">API</span> and we thought it would be cool to get a quote from a developer who has done some hacks.  If you&#8217;d rather not participate, no worries whatsoever.  If you&#8217;d be willing, following is a quick list of questions:</p>


	<p><strong>Chris Roos</strong></p>


	<p>Cool, I appreciate being considered.</p>


	<p><strong>Debbie Pfeifer</strong></p>


	<p>Why do you use Wesabe?</p>


	<p><strong>Chris Roos</strong></p>


	<p>Because it&#8217;s a great application :-)   No, seriously it&#8217;s because tagging makes sense to me.  It makes sense that, if I buy an apple, I should be able to categorise it as an apple, fruit, lunch, food, groceries and others that I can&#8217;t think of right now.  It&#8217;s a bit looser than traditional finance applications which I find perfect.  I must admit that I don&#8217;t currently use the social side of wesabe, helping others out with tips and advice, but that in no way detracts from the usefulness of the service to me.  I also love the fact that I&#8217;m able to interact with you guys, it means a lot to know that you&#8217;re listening.</p>


	<p><strong>Debbie Pfeifer</strong></p>


	<p>From your blog, I saw the projects you&#8217;ve already done (automating downloads).  Are there other things you&#8217;d like to do with Wesabe once you have the <span class="caps">API</span>?</p>


	<p><strong>Chris Roos</strong></p>


	<p>Hmm, let&#8217;s see.  I&#8217;m a big fan of the command line.  I&#8217;ve already been thinking about tidying up some of the previous work I&#8217;ve done so that it effectively provides a command line interface to my banking websites.  I can see that a command line interface to Wesabe might be quite appealing to me too.  I&#8217;m just wondering about some potential mapping mashups too.  I try to tag my transactions with the place they were purchased. Assuming I tagged every purchase with at least a town or city it&#8217;d be cool to see the distribution geographically.  Actually, I have a feeling I could do this with what&#8217;s available right now so maybe scrap that thought.</p>


	<p><strong>Debbie Pfeifer</strong></p>


	<p>Anything else you&#8217;d like to add?</p>


	<p><strong>Chris Roos</strong></p>


	<p>I originally had this bit under the question of why I like Wesabe, but felt it best here.  To be fair, it probably doesn&#8217;t matter too much. Anyway, I like the fact that Wesabe is developing the software that my greedy, super-rich banks should be developing ;-)   I love the fact that you are, in a small way, changing the world.  Sticking two fingers up at traditional finance applications and banking web apps themselves, because, I assume, you know that you&#8217;re doing it right.</p>


	<p>One other idea I&#8217;ve been thinking about is uploading my mobile phone statements to Wesabe.  I currently have access to a pdf representation of my itemised bill.  I&#8217;m thinking that if I can parse the pdf, or even just copy the content into a text file that I can parse, I could upload and use all the features of Wesabe to analyse my bills.  I think this&#8217;d be great as I&#8217;ve personally never come across a phone company that allows ready, easy access to itemised call data in a useful format.  I guess this is because they don&#8217;t want to make it to easy for us to work out that they&#8217;re screwing us over in some way (cynical huh?).  Anyway, just a thought and I&#8217;m obviously not sure how that&#8217;d sit with you guys&#8230;?</p>


	<p><strong>Debbie Pfeifer</strong></p>


	<p>Again, if you&#8217;d rather not do this, I totally understand.  If you&#8217;re game, could we use your name?  Also, how would you describe yourself&#8230; a (your job) from (city)?</p>


	<p><strong>Chris Roos</strong></p>


	<p>Feel free to use my name.  Although not really one for titles, I guess I&#8217;d be classed as a software developer working in London, but from Ramsgate.</p>


	<p><strong>Debbie Pfeifer</strong></p>


	<p>Thanks, Chris.  Please let me know if you have any questions.</p>


	<p><strong>Chris Roos</strong></p>


	<p>One quick question.  Am I able to publish this email to my blog?  If not, I&#8217;ll probably just published my answers to your questions, which I could paraphrase to offer context.</p>


	<p>Cheers, and hope there&#8217;s at least something useful in these ramblings.</p>


	<p>Chris</p>


	<p><strong>Debbie Pfeifer</strong></p>


	<p>Best,
Debbie Pfeifer
Wesabe</p>


	<p><strong>Update 17:10 &#8211; made the email legible. Thanks Paul.</strong></p>
            </div>
        
            <p class="meta">
              
                Tags 
                
                  <a href="/articles/tag/api" rel="tag">api</a>, 
                
                  <a href="/articles/tag/cool" rel="tag">cool</a>, 
                
                  <a href="/articles/tag/pr" rel="tag">pr</a>, 
                
                  <a href="/articles/tag/praise" rel="tag">praise</a>, 
                
                  <a href="/articles/tag/ramble" rel="tag">ramble</a>, 
                
                  <a href="/articles/tag/wesabe" rel="tag">wesabe</a>, 
                
              
            </p>
          
            <div class="post">
              <h2>
                <a href="/articles/2007/04/03/obtaining-latitude-longitude-for-uk-postcodes">Obtaining latitude/longitude for UK postcodes</a>
              </h2>
              <p class="auth">
                Posted by Chris Roos
                <span class="typo_date" title="Tue, 03 Apr 2007 21:33:00">
                  Tue, 03 Apr 2007 21:33:00
                </span>
              </p>
          
              <p>It turns out that we can use <a href="http://streetmap.co.uk">streetmap.co.uk</a> to <a href="http://streetmap.co.uk/streetmap.dll?GridConvert">convert</a> a UK postcode to latitude/longitude.  It also turns out that a combination of <a href="http://curl.haxx.se/">curl</a>, <a href="http://www.ruby-lang.org">ruby</a> and <a href="http://code.whytheluckystiff.net/hpricot/">hpricot</a> make it very easy to bypass the streetmap site to perform the conversion.</p>


<div class="typocode"><pre><code class="typocode_ruby"><span class="ident">postcode</span> <span class="punct">=</span> <span class="punct">'</span><span class="string">SW1A 2AJ</span><span class="punct">'</span>

<span class="ident">html</span> <span class="punct">=</span> `<span class="ident">curl</span> <span class="punct">&quot;</span><span class="string">http://streetmap.co.uk/streetmap.dll</span><span class="punct">&quot;</span> <span class="punct">-</span><span class="ident">d</span><span class="punct">&quot;</span><span class="string">MfcISAPICommand=GridConvert</span><span class="punct">&quot;</span> <span class="punct">-</span><span class="ident">d</span><span class="punct">&quot;</span><span class="string">name=<span class="expr">#{postcode}</span></span><span class="punct">&quot;</span> <span class="punct">-</span><span class="ident">d</span><span class="punct">&quot;</span><span class="string">type=PostCode</span><span class="punct">&quot;`</span>

<span class="ident">require</span> <span class="punct">'</span><span class="string">rubygems</span><span class="punct">'</span>
<span class="ident">require</span> <span class="punct">'</span><span class="string">hpricot</span><span class="punct">'</span>

<span class="ident">doc</span> <span class="punct">=</span> <span class="constant">Hpricot</span><span class="punct">(</span><span class="ident">html</span><span class="punct">)</span>

<span class="ident">latitude</span><span class="punct">,</span> <span class="ident">longitude</span> <span class="punct">=</span> <span class="number">0</span><span class="punct">,</span> <span class="number">0</span>

<span class="punct">(</span><span class="ident">doc</span><span class="punct">/&quot;</span><span class="string">div</span><span class="punct">&quot;/&quot;</span><span class="string">center</span><span class="punct">&quot;/&quot;</span><span class="string">table</span><span class="punct">&quot;/&quot;</span><span class="string">tr</span><span class="punct">&quot;).</span><span class="ident">each</span> <span class="keyword">do</span> <span class="punct">|</span><span class="ident">row</span><span class="punct">|</span>
  <span class="ident">attribute</span> <span class="punct">=</span> <span class="punct">(</span><span class="ident">row</span><span class="punct">/&quot;</span><span class="string">td</span><span class="punct">&quot;).</span><span class="ident">first</span><span class="punct">.</span><span class="ident">inner_text</span>
  <span class="ident">value</span> <span class="punct">=</span> <span class="punct">(</span><span class="ident">row</span><span class="punct">/&quot;</span><span class="string">td</span><span class="punct">&quot;).</span><span class="ident">last</span><span class="punct">.</span><span class="ident">inner_text</span>
  <span class="keyword">if</span> <span class="ident">attribute</span> <span class="punct">=~</span> <span class="punct">/</span><span class="regex">lat</span><span class="punct">/</span><span class="ident">i</span>
    <span class="ident">latitude</span> <span class="punct">=</span> <span class="constant">Float</span><span class="punct">(</span><span class="ident">value</span><span class="punct">[/</span><span class="regex"><span class="escape">\(</span>(.*)<span class="escape">\)</span></span><span class="punct">/,</span> <span class="number">1</span><span class="punct">])</span>
  <span class="keyword">elsif</span> <span class="ident">attribute</span> <span class="punct">=~</span> <span class="punct">/</span><span class="regex">long</span><span class="punct">/</span><span class="ident">i</span>
    <span class="ident">longitude</span> <span class="punct">=</span> <span class="constant">Float</span><span class="punct">(</span><span class="ident">value</span><span class="punct">[/</span><span class="regex"><span class="escape">\(</span>(.*)<span class="escape">\)</span></span><span class="punct">/,</span> <span class="number">1</span><span class="punct">])</span>
  <span class="keyword">end</span>
<span class="keyword">end</span>

<span class="ident">p</span> <span class="punct">[</span><span class="ident">latitude</span><span class="punct">,</span> <span class="ident">longitude</span><span class="punct">]</span></code></pre></div>

	<p>Err, this is probably a bit naughty.</p>
            </div>
        
            <p class="meta">
              
                Tags 
                
                  <a href="/articles/tag/cool" rel="tag">cool</a>, 
                
                  <a href="/articles/tag/naughty" rel="tag">naughty</a>, 
                
                  <a href="/articles/tag/ruby" rel="tag">ruby</a>, 
                
                  <a href="/articles/tag/streetmap" rel="tag">streetmap</a>, 
                
              
            </p>
          
            <div class="post">
              <h2>
                <a href="/articles/2007/01/12/combining-distributed-small-tools-as-an-alternative-to-backpack-et-al">Combining distributed small tools as an alternative to Backpack et al</a>
              </h2>
              <p class="auth">
                Posted by Chris Roos
                <span class="typo_date" title="Fri, 12 Jan 2007 11:53:00">
                  Fri, 12 Jan 2007 11:53:00
                </span>
              </p>
          
              <p>For a while now, I&#8217;ve been thinking/dreaming of having a number of very specific, distributed services.  These would be no more than additions to the single purpose services we already use (notably, in my case, <a href="http://flickr.com">flickr</a> for photos, this blog for articulating thought and <a href="http://del.icio.us">del.icio.us</a> for storing bookmarks).  Some additions I&#8217;d like to see<sup><a href="#fn1">1</a></sup> are:</p>


	<ul>
	<li>A way to record and tag financial transactions

	<p>Although I want to be able to record the transactions in some kind of accounting app, I also want each transaction to be a resource on the web that I can link to and bookmark (a RESTful accounts app if you like)</p></li>
	</ul>


	<ul>
	<li>A way to record and tag any text (i.e. thoughts and ideas that are not quite blog posts)

	<p>To be fair, a secondary blog could be set-up to do this.</p></li>
	</ul>


	<ul>
	<li>A way to add multiple comments to any resource on the web

	<p>Think &#8211; being able to bookmark the same uri multiple times in del.icio.us with different notes against each bookmark.  Actually, I wonder why these sort of distributed comment systems are not more prevalent &#8211; it seems kinda odd that every blogging engine re-implements something that could be done once, and done well.</p></li>
	</ul>


	<ul>
	<li>A way to expose an email or an email conversation at a given uri (a permailink maybe? he he)

	<p>I think one immediate benefit of this is the ability to share emails with people in the same organisation/group as you without having to forward them all on.</p></li>
	</ul>


	<p>So, how would having these types of services help us re-create a backpack type page at present?</p>


	<p>Well, I&#8217;m not sure how good this example is, but let&#8217;s think of selling an item on <a href="http://www.ebay.co.uk">ebay</a>.  At the moment, I end up with lots of distributed information about a single sale:</p>


	<ul>
	<li>invoices from ebay</li>
		<li>transactions on a statement (from my bank and paypal)</li>
		<li>emails from ebay and buyers</li>
		<li>a page that represents the item on ebay</li>
		<li>pictures of the item on flickr</li>
		<li>physical receipts for posting the item</li>
	</ul>


	<p>This is fine until you want to interrogate the data.  Try finding out how much money you made/lost, when it was sent, who it was sent to, and the problems are obvious.</p>


	<p>One solution would be to record all the information for a given item in a page in backpack (or any similar service &#8211; a simple wiki would do).  But now try to query the data for two items sold, or partially query one item and the problems become evident again.</p>


	<p>I think this is where our funky new distributed system can help.  Following the same ebay selling process as above:</p>


	<ul>
	<li>We create a text snippet that provides us with a placeholder uri for this item.  This would be something like &#8216;sale of computer&#8217;</li>
		<li>We upload photos of the item to flickr, tagged with our placeholder</li>
		<li>We list the item in ebay, tagged with our placeholder</li>
		<li>We record a financial transaction that represents the cost of listing the item, tagged with our placeholder</li>
		<li>We upload any relevant emails from ebay about the listing/sale of our item, tagged with our placeholder</li>
		<li>We record a financial transaction that represents our income from the sale of the item, tagged with our placeholder</li>
		<li>We record a note that states when and how we sent the item, tagged with our placeholder</li>
		<li>We record a financial transaction that represents our cost for sending the item, tagged with our placeholder</li>
	</ul>


	<p>The important thing is that all of these resources are tagged with a common uri.  The uri that represents our item for sale.  At the simplest level, this makes auto-generating a backpack type page very simple &#8211; we just aggregate<sup><a href="#fn2">2</a></sup> all of the data tagged with our item uri.  Tagging these items with a higher level tag, such as &#8216;ebay&#8217;, will allow us to search across multiple sales/purchase.</p>


	<p>Going even further, using opensearch with a simple custom front-end (basically just a parser) gives us even greater querying capabilities.  I could imagine searching for something like &#8220;ebay finance:expenditure&#8221; to get a list of all items (descriptions, notes, pictures etc) we&#8217;ve sold on ebay along with our expenditure.  Our simple search engine would know to search for all items tagged with ebay, but only those transactions that are tagged with expenditure (i.e. costs to us).</p>


	<p>Does this make sense/sound feasible to anyone else?  Indeed, has someone else already presented these ideas in a more legible/understandable way?  It all seems to make great sense to me but I&#8217;ve spent quite a while thinking about it (and what seems like ages just writing this post), meaning there&#8217;s every chance I&#8217;ve missed something obvious.  I&#8217;d appreciate any thoughts.</p>


	<p id="fn1"><sup>1</sup> I did had every intention of developing these things as a proof of concept, but, on the basis that I&#8217;m unlikely to get around to it, and that I do actually think something like this is a good idea, I thought I&#8217;d jot my thoughts here.</p>


	<p id="fn2"><sup>2</sup> I started out thinking that the tags would be stored against the resource itself &#8211; the same way that the tag for a photo in flickr is stored against that photo.  I was also assuming that these services would be <a href="http://opensearch.org">opensearch</a> enabled to allow searching of the tags.  As I&#8217;ve been writing the post I&#8217;ve realised that, providing everything has a uri, we can use del.icio.us as our tagging mechanism and as our search engine.</p>
            </div>
        
            <p class="meta">
              
                Tags 
                
                  <a href="/articles/tag/cool" rel="tag">cool</a>, 
                
                  <a href="/articles/tag/distributed" rel="tag">distributed</a>, 
                
                  <a href="/articles/tag/opensearch" rel="tag">opensearch</a>, 
                
                  <a href="/articles/tag/rest" rel="tag">rest</a>, 
                
                  <a href="/articles/tag/software" rel="tag">software</a>, 
                
              
            </p>
          
            <div class="post">
              <h2>
                <a href="/articles/2007/01/04/homegrown-gooogie">Homegrown gooogie</a>
              </h2>
              <p class="auth">
                Posted by Chris Roos
                <span class="typo_date" title="Thu, 04 Jan 2007 14:37:00">
                  Thu, 04 Jan 2007 14:37:00
                </span>
              </p>
          
              <p>So, I just saw a <a href="http://blog.outer-court.com/archive/2007-01-04.html#n31">post</a> about <a href="http://www.gooogie.co.uk">gooogie</a>, and it reminded me of my <a href="http://blog.seagul.co.uk/articles/2006/12/15/might-as-well-aim-high">own</a>, &#8216;did you mean&#8217;, page<sup><a href="#fn1">1</a></sup>.</p>


	<p>You can achieve the same effect as gooogie by using the excellent <a href="https://addons.mozilla.org/firefox/1843/">firebug</a> firefox extension to execute javascript in the context of the page you are viewing.</p>


	<p>To achieve the effect:</p>


	<ul>
	<li>Open up <a href="http://www.google.co.uk">google</a></li>
	</ul>


	<ul>
	<li>Type something into the search box that will generate a &#8216;did you mean&#8217; response (tip. use any <a href="http://www.google.co.uk/search?hl=en&#38;q=mispeled&#38;btnG=Google+Search">misspelled</a> word)</li>
	</ul>


	<ul>
	<li>Use the handy <a href="https://addons.mozilla.org/firefox/1192/">XPather</a> firefox extension to find the XPath expression of the suggested word (in italics).  At this time, the relevant xpath seems to be &#8217;/html/body/p<sup><a href="#fn1">1</a></sup>/a/b/i&#8217;</li>
	</ul>


	<ul>
	<li>Fire up firebug and execute the following line in the console, substituting your desired suggestion first (the text on the page should change immediately)</li>
	</ul>


<div class="typocode"><pre><code class="typocode_default">document.evaluate('/html/body/p[1]/a/b/i', document, null, XPathResult.ANY_TYPE, null).iterateNext().textContent = 'THE_WORD_YOU_WANT_TO_SUGGEST'</code></pre></div>

	<ul>
	<li>Finish by typing a new word into the search box and taking a screenshot to impress your friends (or not, as the case may be).</li>
	</ul>


	<p>On second thoughts, just use gooogie, it&#8217;s much quicker and cross-browser compatible.</p>


	<p id="fn1"><sup>1</sup> A handful of people have stated that they don&#8217;t get the &#8216;did you mean reevoo&#8217; message when typing &#8216;review&#8217; into google.  Well, no, they wouldn&#8217;t.  It&#8217;s completely made up.  He he.</p>
            </div>
        
            <p class="meta">
              
                Tags 
                
                  <a href="/articles/tag/cool" rel="tag">cool</a>, 
                
                  <a href="/articles/tag/google" rel="tag">google</a>, 
                
                  <a href="/articles/tag/gooogie" rel="tag">gooogie</a>, 
                
                  <a href="/articles/tag/hack" rel="tag">hack</a>, 
                
              
            </p>
          
            <div class="post">
              <h2>
                <a href="/articles/2006/12/24/curl-is-fast-becoming-my-favourite-toy">cURL is fast becoming my favourite toy</a>
              </h2>
              <p class="auth">
                Posted by Chris Roos
                <span class="typo_date" title="Sun, 24 Dec 2006 17:04:00">
                  Sun, 24 Dec 2006 17:04:00
                </span>
              </p>
          
              <h3>(or programmatically logging into online banking to retrieve my balance)</h3>


	<p>In order to make practical use<sup><a href="#fn1">1</a></sup> of my new found <a href="http://blog.seagul.co.uk/articles/2006/12/14/addicted-to-twitter-com">sms gateway</a>, I&#8217;ve created a ruby script that logs into my hsbc bank account and scrapes the balance from the screen.</p>


<div class="typocode"><pre><code class="typocode_ruby"><span class="constant">COOKIE_LOCATION</span> <span class="punct">=</span> <span class="punct">'</span><span class="string">/Users/chrisroos/hsbc_cookie</span><span class="punct">'</span>

<span class="constant">INTERNET_BANKING_ID</span> <span class="punct">=</span> <span class="punct">'</span><span class="string">YOUR_INTERNET_BANKING_ID</span><span class="punct">'</span>
<span class="constant">DATE_OF_BIRTH</span> <span class="punct">=</span> <span class="punct">'</span><span class="string">YOUR_DATE_OF_BIRTH</span><span class="punct">'</span>
<span class="constant">SECURITY_CODE</span> <span class="punct">=</span> <span class="punct">'</span><span class="string">YOUR_SECURITY_CODE</span><span class="punct">'</span>
<span class="keyword">class </span><span class="punct">&lt;&lt;</span> <span class="constant">SECURITY_CODE</span>
  <span class="punct">[</span><span class="symbol">:first</span><span class="punct">,</span> <span class="symbol">:second</span><span class="punct">,</span> <span class="symbol">:third</span><span class="punct">,</span> <span class="symbol">:fourth</span><span class="punct">,</span> <span class="symbol">:fifth</span><span class="punct">,</span> <span class="symbol">:sixth</span><span class="punct">,</span> <span class="symbol">:last</span><span class="punct">].</span><span class="ident">each_with_index</span> <span class="keyword">do</span> <span class="punct">|</span><span class="ident">method</span><span class="punct">,</span> <span class="ident">index</span><span class="punct">|</span>
    <span class="ident">define_method</span><span class="punct">(</span><span class="ident">method</span><span class="punct">)</span> <span class="keyword">do</span> 
      <span class="ident">method</span> <span class="punct">==</span> <span class="symbol">:last</span> <span class="punct">?</span> <span class="constant">self</span><span class="punct">.</span><span class="ident">split</span><span class="punct">('</span><span class="string"></span><span class="punct">').</span><span class="ident">last</span> <span class="punct">:</span> <span class="constant">self</span><span class="punct">.</span><span class="ident">split</span><span class="punct">('</span><span class="string"></span><span class="punct">')[</span><span class="ident">index</span><span class="punct">]</span>
    <span class="keyword">end</span>
  <span class="keyword">end</span>
<span class="keyword">end</span>

<span class="comment"># POST Internet Banking ID and store the cookie</span>
<span class="ident">curl_cmd</span> <span class="punct">=</span> <span class="punct">%[</span><span class="string">curl -s -c&quot;<span class="expr">#{COOKIE_LOCATION}</span>&quot; -L -d&quot;internetBankingID=<span class="expr">#{INTERNET_BANKING_ID}</span>&quot; &quot;https://www.ebank.hsbc.co.uk/servlet/com.hsbc.ib.app.pib.logon.servlet.OnBrochurewareLogonServlet&quot;</span><span class="punct">]</span>
`<span class="comment">#{curl_cmd}`</span>

<span class="comment"># GET Login page so that we can work out which characters it wants</span>
<span class="ident">curl_cmd</span> <span class="punct">=</span> <span class="punct">%[</span><span class="string">curl -s -b&quot;<span class="expr">#{COOKIE_LOCATION}</span>&quot; &quot;https://www.ebank.hsbc.co.uk/main/IBLogon.jsp&quot;</span><span class="punct">]</span>
<span class="ident">login_page</span> <span class="punct">=</span> `<span class="comment">#{curl_cmd}`</span>

<span class="comment"># p login_page[/Please enter the (.+), (.+) and (.+) digits of your security number/]</span>
<span class="ident">c1</span> <span class="punct">=</span> <span class="ident">login_page</span><span class="punct">[/</span><span class="regex">Please enter the (.+), (.+) and (.+) digits of your security number</span><span class="punct">/,</span> <span class="number">1</span><span class="punct">].</span><span class="ident">downcase</span>
<span class="ident">c2</span> <span class="punct">=</span> <span class="ident">login_page</span><span class="punct">[/</span><span class="regex">Please enter the (.+), (.+) and (.+) digits of your security number</span><span class="punct">/,</span> <span class="number">2</span><span class="punct">].</span><span class="ident">downcase</span>
<span class="ident">c3</span> <span class="punct">=</span> <span class="ident">login_page</span><span class="punct">[/</span><span class="regex">Please enter the (.+), (.+) and (.+) digits of your security number</span><span class="punct">/,</span> <span class="number">3</span><span class="punct">].</span><span class="ident">downcase</span>
<span class="ident">tsn</span> <span class="punct">=</span> <span class="punct">[</span><span class="ident">c1</span><span class="punct">,</span> <span class="ident">c2</span><span class="punct">,</span> <span class="ident">c3</span><span class="punct">].</span><span class="ident">collect</span> <span class="punct">{</span> <span class="punct">|</span><span class="ident">method</span><span class="punct">|</span> <span class="constant">SECURITY_CODE</span><span class="punct">.</span><span class="ident">__send__</span><span class="punct">(</span><span class="ident">method</span><span class="punct">)</span> <span class="punct">}.</span><span class="ident">join</span>
<span class="comment"># p tsn</span>

<span class="comment"># POST to login now that we've (hopefully) created the tsn</span>
<span class="ident">curl_cmd</span> <span class="punct">=</span> <span class="punct">%[</span><span class="string">curl -s -b&quot;<span class="expr">#{COOKIE_LOCATION}</span>&quot; -L -d&quot;dateOfBirth=<span class="expr">#{DATE_OF_BIRTH}</span>&quot; -d&quot;tsn=<span class="expr">#{tsn}</span>&quot; &quot;https://www.ebank.hsbc.co.uk/servlet/com.hsbc.ib.app.pib.logon.servlet.OnLogonVerificationServlet&quot;</span><span class="punct">]</span>
`<span class="comment">#{curl_cmd}`</span>

<span class="comment"># GET the account overview page to scrape the balance from it</span>
<span class="ident">curl_cmd</span> <span class="punct">=</span> <span class="punct">%[</span><span class="string">curl -s -b&quot;<span class="expr">#{COOKIE_LOCATION}</span>&quot; &quot;https://www.ebank.hsbc.co.uk/main/portmain.jsp&quot;</span><span class="punct">]</span>
<span class="ident">account_overview_html</span> <span class="punct">=</span> `<span class="comment">#{curl_cmd}`</span>

<span class="comment"># Remove the cookie</span>
`<span class="ident">rm</span> <span class="comment">#{COOKIE_LOCATION}`</span>

<span class="comment"># Obtain and display the account balance</span>
<span class="ident">account_balance</span> <span class="punct">=</span> <span class="ident">account_overview_html</span><span class="punct">[/</span><span class="regex">&lt;td.*?&gt;(<span class="escape">\d</span>+.?<span class="escape">\d</span>+?<span class="escape">\s</span>*C|D)&lt;<span class="escape">\/</span>td&gt;</span><span class="punct">/,</span> <span class="number">1</span><span class="punct">]</span>
<span class="ident">puts</span> <span class="ident">account_balance</span></code></pre></div>

	<p id="fn1"><sup>1</sup>  I will probably never ever use this.  Oh well.</p>
            </div>
        
            <p class="meta">
              
                Tags 
                
                  <a href="/articles/tag/cool" rel="tag">cool</a>, 
                
                  <a href="/articles/tag/curl" rel="tag">curl</a>, 
                
                  <a href="/articles/tag/hack" rel="tag">hack</a>, 
                
                  <a href="/articles/tag/hsbc" rel="tag">hsbc</a>, 
                
                  <a href="/articles/tag/ruby" rel="tag">ruby</a>, 
                
              
            </p>
          

        </div>

        <div id="sidebar">

          <div class="sidebar-node">
            <h3>Syndicate</h3>
            <a href="http://feeds.feedburner.com/DeferredUntilInspirationHits" title="Subscribe to my feed, deferred until inspiration hits" rel="alternate" type="application/rss+xml">
              <img src="http://www.feedburner.com/fb/images/pub/feed-icon16x16.png" alt="" style="border:0"/> 
              Subscribe to the feed
            </a>
          </div>

        </div>

        <br clear="all" />

      </div>
    
      <div id="footer">
      </div>

    </div>
  
  </body>

</html>